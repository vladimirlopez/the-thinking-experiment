<div class="newsletter" style="margin-top:2rem; padding:1rem; border:1px solid var(--bs-border-color,#495057); border-radius:6px; background: rgba(0,0,0,0.05)">
  <strong>Get new posts:</strong>
  <p style="margin:0.5rem 0 0.75rem 0;">Subscribe via email (Buttondown) or RSS.</p>
  <form id="bd-form" action="https://buttondown.email/api/emails/embed-subscribe/{{< meta buttondown_handle >}}" method="post" target="popupwindow" onsubmit="window.open('https://buttondown.email/{{< meta buttondown_handle >}}', 'popupwindow')" class="embeddable-buttondown-form" style="display:flex; gap:0.5rem; flex-wrap:wrap;">
    <input type="email" name="email" id="bd-email" placeholder="your@email" required style="flex:1; min-width:220px; padding:0.4rem; border-radius:4px; border:1px solid #495057; background:#2c3035; color:#e0e0e0;">
    <input type="hidden" value="1" name="embed" />
    <button type="submit" style="padding:0.4rem 0.8rem; border:1px solid #00BCD4; background:transparent; color:#00BCD4; border-radius:4px;">Subscribe</button>
  </form>
  <div style="margin-top:0.5rem; font-size:0.9em; opacity:0.85;">
    Or subscribe via <a id="rss-link" href="index.xml" target="_blank" rel="noopener">RSS</a> or follow on <a href="https://www.linkedin.com/in/vladimirglopez" target="_blank" rel="noopener">LinkedIn</a>.
  </div>
  <script>
    // Hide Buttondown form if handle not set (renders empty); keep RSS fallback
    (function(){
      var h = "{{< meta buttondown_handle >}}".trim();
      if (!h) { var f = document.getElementById('bd-form'); if (f) f.style.display = 'none'; }
      // Fix RSS link for local vs. GitHub Pages base path
      var rss = document.getElementById('rss-link');
      if (rss) {
        var base = window.location.pathname.startsWith('/the-thinking-experiment') ? '/the-thinking-experiment/' : '/';
        rss.href = base + 'index.xml';
      }
    })();
  </script>
</div>
